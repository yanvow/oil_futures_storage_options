(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     62731,       1690]
NotebookOptionsPosition[     55695,       1578]
NotebookOutlinePosition[     56031,       1593]
CellTagsIndexPosition[     55988,       1590]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Bond, futures and futures option pricing in the Black-Scholes model with \
Vasicek interest rate.\
\>", "Section",
 CellChangeTimes->{{3.5455584000935593`*^9, 3.545558428412129*^9}, {
  3.641289292940473*^9, 
  3.641289298129443*^9}},ExpressionUUID->"60710e51-9698-4779-9391-\
eab9d004ee39"],

Cell[CellGroupData[{

Cell["Zero coupon bond pricing", "Subsection",
 CellChangeTimes->{{3.545388256049943*^9, 3.545388257712409*^9}, {
  3.545555219561202*^9, 
  3.545555222702744*^9}},ExpressionUUID->"0b4d1ce0-7d70-49d4-bef4-\
8a3707cf5341"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDE", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"B", "[", 
      RowBox[{
       RowBox[{"T", "-", "t"}], ",", "r"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "r"], 
      RowBox[{"B", "[", 
       RowBox[{
        RowBox[{"T", "-", "t"}], ",", "r"}], "]"}]}], "*", "\[Lambda]", "*", 
     RowBox[{"(", 
      RowBox[{"rb", "-", "r"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"r", ",", "r"}]], 
      RowBox[{"B", "[", 
       RowBox[{
        RowBox[{"T", "-", "t"}], ",", "r"}], "]"}]}], "*", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Nu]1", "2"], "+", 
        SuperscriptBox["\[Nu]2", "2"]}], ")"}], "2"]}], "-", 
    RowBox[{"r", "*", 
     RowBox[{"B", "[", 
      RowBox[{
       RowBox[{"T", "-", "t"}], ",", "r"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.54538241867061*^9, 3.5453824539367867`*^9}, {
  3.545382542882859*^9, 3.5453825702595673`*^9}, {3.5455556620173197`*^9, 
  3.5455556691055193`*^9}, {3.6082898606775208`*^9, 
  3.608289882676868*^9}},ExpressionUUID->"3edfc7a1-f9e0-4eef-b8d1-\
135823d6c14f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"a", ",", "b", ",", "B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "[", 
   RowBox[{"\[Tau]_", ",", "r_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"a", "[", "\[Tau]", "]"}]}], "-", 
    RowBox[{
     RowBox[{"b", "[", "\[Tau]", "]"}], "*", "r"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5453824661766567`*^9, 3.5453824780899343`*^9}, {
  3.545388205609614*^9, 3.5453882059553623`*^9}, {3.5455552318105*^9, 
  3.5455552352094584`*^9}, {3.5455563204454117`*^9, 3.5455563225717707`*^9}, {
  3.576225582381098*^9, 3.5762255837232447`*^9}, {3.6082898871163073`*^9, 
  3.608289904924909*^9}},ExpressionUUID->"890fc6d9-4944-47e6-9398-\
1da66cdbe32b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDE0", "=", 
  RowBox[{
   RowBox[{
    FractionBox["PDE", 
     RowBox[{" ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"a", "[", 
          RowBox[{"T", "-", "t"}], "]"}]}], "-", 
        RowBox[{"r", " ", 
         RowBox[{"b", "[", 
          RowBox[{"T", "-", "t"}], "]"}]}]}]], " "}]], "/.", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{"T", "-", "\[Tau]"}]}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.545382479929929*^9, 3.545382494839877*^9}, {
  3.545555244849246*^9, 3.545555314850378*^9}, {3.545556333540423*^9, 
  3.545556338427417*^9}, {3.576225588811327*^9, 3.576225590947299*^9}, {
  3.608289909573077*^9, 
  3.608289936125237*^9}},ExpressionUUID->"b79d8357-301a-43a2-8da5-\
fc0476ac6d60"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r", "-", "rb"}], ")"}], " ", "\[Lambda]", " ", 
   RowBox[{"b", "[", "\[Tau]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Nu]1", "2"], "+", 
     SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"b", "[", "\[Tau]", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["a", "\[Prime]",
    MultilineFunction->None], "[", "\[Tau]", "]"}], "+", 
  RowBox[{"r", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      SuperscriptBox["b", "\[Prime]",
       MultilineFunction->None], "[", "\[Tau]", "]"}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.5453824806030207`*^9, 3.5453824955397863`*^9}, {
   3.54538255821168*^9, 3.545382576863613*^9}, {3.5453882104840317`*^9, 
   3.545388220436308*^9}, {3.545555249103804*^9, 3.545555315999543*^9}, 
   3.545555680911268*^9, 3.5455563391105347`*^9, 3.5455563947250147`*^9, 
   3.576225591704957*^9, {3.6082899243058968`*^9, 3.608289936939351*^9}, 
   3.639718768658352*^9, 3.639817237886813*^9, {3.639817407897902*^9, 
   3.6398174503004713`*^9}, 
   3.6412819100824423`*^9},ExpressionUUID->"a41e7287-1e6d-48bc-bee5-\
5294fcd7c78a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ODEb", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"PDE0", ",", "r"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ODEa", "=", 
  RowBox[{
   RowBox[{"PDE0", "-", 
    RowBox[{"r", "*", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"PDE0", ",", "r"}], "]"}]}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.545555274975024*^9, 3.545555308937015*^9}, {
  3.545555348906969*^9, 3.545555353314102*^9}, {3.576225600595799*^9, 
  3.576225601891779*^9}, {3.608289944085484*^9, 
  3.608289945261012*^9}},ExpressionUUID->"d1f080e0-b794-4fc1-9f62-\
e5b8904b8ff3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"b", "[", "\[Tau]", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["b", "\[Prime]",
    MultilineFunction->None], "[", "\[Tau]", "]"}]}]], "Output",
 CellChangeTimes->{{3.5455552813394833`*^9, 3.54555531747125*^9}, 
   3.545555354553423*^9, 3.545555682650148*^9, 3.54555634181754*^9, 
   3.545556395711813*^9, {3.57622559436316*^9, 3.5762256025853033`*^9}, 
   3.6082899479351587`*^9, 3.639718768725032*^9, 3.63981723794359*^9, {
   3.639817407936651*^9, 3.6398174503403597`*^9}, 
   3.6412819101203833`*^9},ExpressionUUID->"fd79787c-57ce-40c0-b985-\
2b66d8af52e6"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "rb", " ", "\[Lambda]", " ", 
     RowBox[{"b", "[", "\[Tau]", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Nu]1", "2"], "+", 
       SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "\[Tau]", "]"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{
      SuperscriptBox["a", "\[Prime]",
       MultilineFunction->None], "[", "\[Tau]", "]"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.5455552813394833`*^9, 3.54555531747125*^9}, 
   3.545555354553423*^9, 3.545555682650148*^9, 3.54555634181754*^9, 
   3.545556395711813*^9, {3.57622559436316*^9, 3.5762256025853033`*^9}, 
   3.6082899479351587`*^9, 3.639718768725032*^9, 3.63981723794359*^9, {
   3.639817407936651*^9, 3.6398174503403597`*^9}, 
   3.641281910121812*^9},ExpressionUUID->"fc73fc1a-47d7-42db-b109-\
43d9bb87aae3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"b", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"ODEb", "\[Equal]", "0"}]}], "}"}], ",", 
     RowBox[{"b", "[", "\[Tau]", "]"}], ",", "\[Tau]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.545382584359974*^9, 3.5453826050498943`*^9}, {
  3.545555326250437*^9, 3.545555368162681*^9}, {3.545555415347612*^9, 
  3.545555417451085*^9}, {3.545556345283662*^9, 3.545556349883634*^9}, {
  3.5762256049556217`*^9, 3.576225608339642*^9}, {3.608289951614037*^9, 
  3.6082899639341707`*^9}},ExpressionUUID->"eaa30d21-51d2-4a19-a8f4-\
71e311c08e4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"b", "[", "\[Tau]", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], " ", "\[Tau]"}]]}], "\[Lambda]"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.545382600588895*^9, 3.545382605518146*^9}, 
   3.5453882231828413`*^9, {3.5455553381665993`*^9, 3.545555368808096*^9}, 
   3.545555418089327*^9, 3.545555684278612*^9, 3.545556350743541*^9, 
   3.545556396697624*^9, 3.5762256092614107`*^9, 3.6082899651491013`*^9, 
   3.639718768811736*^9, 3.639817237992877*^9, {3.6398174080313673`*^9, 
   3.639817450433796*^9}, 
   3.641281910214829*^9},ExpressionUUID->"e94eab3c-0d2d-431f-81d0-\
2b1cbfed55ce"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "[", "\[Tau]_", "]"}], ":=", 
  FractionBox[
   RowBox[{"1", "-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", "\[Tau]"}]]}], "\[Lambda]"]}]], "Input",\

 CellChangeTimes->{{3.545555442256961*^9, 3.545555454564803*^9}, {
  3.545556358507859*^9, 3.545556387004157*^9}, {3.57622561387751*^9, 
  3.576225627851975*^9}, {3.608289968142034*^9, 
  3.608289978568729*^9}},ExpressionUUID->"4245f460-36f6-4864-abef-\
81ab59d7c3c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ODEa", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"a", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
     RowBox[{"a", "[", "\[Tau]", "]"}], ",", "\[Tau]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.545382610897728*^9, 3.545382647864087*^9}, {
  3.5455553775675*^9, 3.545555421147044*^9}, {3.545556364915999*^9, 
  3.5455563711478977`*^9}, {3.576225632172329*^9, 3.576225635892208*^9}, {
  3.608289985110504*^9, 
  3.608289995670784*^9}},ExpressionUUID->"db9f3ea4-aaac-452f-b475-\
602a7aea011e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "[", "\[Tau]", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Nu]1", "2"], "+", 
       SuperscriptBox["\[Nu]2", "2"], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Lambda]", " ", "\[Tau]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rb", " ", 
           SuperscriptBox["\[Lambda]", "2"]}], "-", 
          SuperscriptBox["\[Nu]1", "2"], "-", 
          SuperscriptBox["\[Nu]2", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "rb", " ", 
           SuperscriptBox["\[Lambda]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Nu]1", "2"], "+", 
             SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["\[Lambda]", "3"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.545382635852532*^9, 3.545382648567327*^9}, 
   3.5453882288199673`*^9, {3.545555385628149*^9, 3.545555421941577*^9}, 
   3.545555457309147*^9, 3.545555686540996*^9, {3.5455563736928062`*^9, 
   3.545556399516897*^9}, 3.576225637781867*^9, 3.608289998010697*^9, 
   3.639718768967992*^9, 3.639817238165207*^9, {3.639817408217886*^9, 
   3.6398174505934477`*^9}, 
   3.64128191041964*^9},ExpressionUUID->"40919ea6-23ac-4379-a2b9-\
4bd9020fcf82"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", "\[Tau]_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Nu]1", "2"], "+", 
      SuperscriptBox["\[Nu]2", "2"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[Lambda]", " ", "\[Tau]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rb", " ", 
          SuperscriptBox["\[Lambda]", "2"]}], "-", 
         SuperscriptBox["\[Nu]1", "2"], "-", 
         SuperscriptBox["\[Nu]2", "2"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "rb", " ", 
          SuperscriptBox["\[Lambda]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[Nu]1", "2"], "+", 
            SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["\[Lambda]", "3"]}]]}]], "Input",
 CellChangeTimes->{{3.5455554662540607`*^9, 3.545555476592957*^9}, 
   3.545555693246069*^9, {3.545556381409544*^9, 3.5455563838799562`*^9}, {
   3.5762256440485783`*^9, 3.576225646246642*^9}, {3.608290012794517*^9, 
   3.608290016408688*^9}, 
   3.608290090690804*^9},ExpressionUUID->"b9f2b1dc-9a4b-4ccf-9ff9-\
a7570bcf48a5"],

Cell["Verification", "Text",
 CellChangeTimes->{{3.545555490636592*^9, 
  3.545555492202668*^9}},ExpressionUUID->"ecf19b56-e372-42d8-a96f-\
b12e666ee1a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDE", "//", "PS"}]], "Input",
 CellChangeTimes->{{3.545555494347239*^9, 3.545555499420096*^9}, {
  3.608290068144724*^9, 
  3.6082900683443727`*^9}},ExpressionUUID->"bda565c8-0568-4078-939f-\
512446472f3f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.5455554951375093`*^9, 3.545555500160016*^9}, 
   3.5455556997917337`*^9, 3.545556404784532*^9, 3.576225650543439*^9, 
   3.608290021737068*^9, {3.608290084400173*^9, 3.608290097837089*^9}, 
   3.639718769149034*^9, 3.639817238344078*^9, {3.639817408391033*^9, 
   3.639817450754198*^9}, 
   3.6412819106018467`*^9},ExpressionUUID->"79c8b861-de33-4ad6-b208-\
1d8c3e74faa5"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Futures pricing", "Subsection",
 CellChangeTimes->{{3.545388256049943*^9, 3.545388257712409*^9}, {
  3.545555219561202*^9, 3.545555222702744*^9}, {3.63981658774504*^9, 
  3.6398165930238047`*^9}},ExpressionUUID->"1fae1f78-3209-4a57-a62a-\
b5bf4f27c100"],

Cell[TextData[{
 "The PDE for the futures price is given by (note the absence of discounting \
since ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", 
     RowBox[{"1", "t"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["E", "Q"], "[", 
       RowBox[{
        SubscriptBox["S", 
         RowBox[{"1", "T"}]], "|", 
        SubscriptBox["F", "t"]}], "]"}], " ", "is", " ", "a", " ", "Q"}], "-", 
     RowBox[{"martingale", "."}]}]}], TraditionalForm]],ExpressionUUID->
  "92bc096a-339f-41ab-a35e-d8b9f7295e1b"]
}], "Text",
 CellChangeTimes->{{3.639816637153256*^9, 
  3.639816689855513*^9}},ExpressionUUID->"f2c6be22-b0c6-4701-b4b8-\
d61ac8d8a992"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDE", "=", 
   RowBox[{
    RowBox[{"r", " ", "S", " ", 
     RowBox[{
      SuperscriptBox["f1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "r", ",", "S"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["S", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Sigma]11", "2"], "+", 
       SuperscriptBox["\[Sigma]12", "2"]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["f1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "r", ",", "S"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "r"}], "+", "rb"}], ")"}], " ", "\[Lambda]", " ", 
     RowBox[{
      SuperscriptBox["f1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "r", ",", "S"}], "]"}]}], "+", 
    RowBox[{"S", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Nu]1", " ", "\[Sigma]11"}], "+", 
       RowBox[{"\[Nu]2", " ", "\[Sigma]12"}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["f1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "r", ",", "S"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[Nu]1", "2"], "+", 
       SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["f1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "r", ",", "S"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["f1", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "r", ",", "S"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.54538241867061*^9, 3.5453824539367867`*^9}, {
   3.545382542882859*^9, 3.5453825702595673`*^9}, {3.5455556620173197`*^9, 
   3.5455556691055193`*^9}, {3.6082898606775208`*^9, 3.608289882676868*^9}, {
   3.6398166046349897`*^9, 3.639816635146863*^9}, 
   3.6398167904049997`*^9},ExpressionUUID->"499c432d-68aa-441c-982b-\
e12e6a4bc592"],

Cell["The conjectured solution is ", "Text",
 CellChangeTimes->{{3.6398169229964857`*^9, 
  3.639816934204444*^9}},ExpressionUUID->"d953b212-95fa-4d14-b536-\
4c30efaab826"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "[", 
   RowBox[{"t_", ",", "r_", ",", "s_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"\[Alpha]", "[", 
      RowBox[{
       SuperscriptBox["T", "*"], "-", "t"}], "]"}], "+", 
     RowBox[{
      RowBox[{"\[Beta]", "[", 
       RowBox[{
        SuperscriptBox["T", "*"], "-", "t"}], "]"}], "*", "r"}]}], "]"}], 
   "s"}]}]], "Input",
 CellChangeTimes->{{3.5453824661766567`*^9, 3.5453824780899343`*^9}, {
   3.545388205609614*^9, 3.5453882059553623`*^9}, {3.5455552318105*^9, 
   3.5455552352094584`*^9}, {3.5455563204454117`*^9, 
   3.5455563225717707`*^9}, {3.576225582381098*^9, 3.5762255837232447`*^9}, {
   3.6082898871163073`*^9, 3.608289904924909*^9}, {3.639816697978292*^9, 
   3.63981671682668*^9}, {3.6398167572191563`*^9, 3.6398167669391193`*^9}, 
   3.6398168023799133`*^9},ExpressionUUID->"788c07ba-9dc4-4045-bfd9-\
c2a1a78bf61b"],

Cell["and substituting into the PDE gives", "Text",
 CellChangeTimes->{{3.639816935762474*^9, 
  3.639816944333662*^9}},ExpressionUUID->"db5e8d2f-ed99-4847-a574-\
91f7d6a4dc93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDE0", "=", 
  RowBox[{
   RowBox[{
    FractionBox["PDE", 
     RowBox[{" ", 
      RowBox[{"f1", "[", 
       RowBox[{"t", ",", "r", ",", "S"}], "]"}], " "}]], "/.", 
    RowBox[{"t", "\[Rule]", 
     RowBox[{
      SuperscriptBox["T", "*"], "-", "\[Tau]"}]}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.545382479929929*^9, 3.545382494839877*^9}, {
  3.545555244849246*^9, 3.545555314850378*^9}, {3.545556333540423*^9, 
  3.545556338427417*^9}, {3.576225588811327*^9, 3.576225590947299*^9}, {
  3.608289909573077*^9, 3.608289936125237*^9}, {3.63981672285881*^9, 
  3.639816728090967*^9}, {3.639816773091357*^9, 
  3.639816823852151*^9}},ExpressionUUID->"ee7e6330-ec8a-4677-9cc7-\
ce4344eb1441"],

Cell[BoxData[
 RowBox[{"r", "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "r"}], " ", "\[Lambda]"}], "+", 
     RowBox[{"rb", " ", "\[Lambda]"}], "+", 
     RowBox[{"\[Nu]1", " ", "\[Sigma]11"}], "+", 
     RowBox[{"\[Nu]2", " ", "\[Sigma]12"}]}], ")"}], " ", 
   RowBox[{"\[Beta]", "[", "\[Tau]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Nu]1", "2"], "+", 
     SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"\[Beta]", "[", "\[Tau]", "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "\[Prime]",
    MultilineFunction->None], "[", "\[Tau]", "]"}], "-", 
  RowBox[{"r", " ", 
   RowBox[{
    SuperscriptBox["\[Beta]", "\[Prime]",
     MultilineFunction->None], "[", "\[Tau]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.5453824806030207`*^9, 3.5453824955397863`*^9}, {
   3.54538255821168*^9, 3.545382576863613*^9}, {3.5453882104840317`*^9, 
   3.545388220436308*^9}, {3.545555249103804*^9, 3.545555315999543*^9}, 
   3.545555680911268*^9, 3.5455563391105347`*^9, 3.5455563947250147`*^9, 
   3.576225591704957*^9, {3.6082899243058968`*^9, 3.608289936939351*^9}, 
   3.639718768658352*^9, {3.639816783851763*^9, 3.639816824841296*^9}, {
   3.63981739294764*^9, 3.639817412555389*^9}, 3.639817456204029*^9, 
   3.641281916757832*^9},ExpressionUUID->"d1c6e41d-7a6c-41ec-9018-\
c903e1b0093f"]
}, Open  ]],

Cell["Separating the variables then gives ODEs for \[Alpha] and \[Beta]", \
"Text",
 CellChangeTimes->{{3.639816949788661*^9, 
  3.6398169705967827`*^9}},ExpressionUUID->"03f3968b-f4dd-43df-b62f-\
3e8b42565994"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ODE\[Beta]", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"PDE0", ",", "r"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ODE\[Alpha]", "=", 
  RowBox[{
   RowBox[{"PDE0", "-", 
    RowBox[{"r", "*", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"PDE0", ",", "r"}], "]"}]}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.545555274975024*^9, 3.545555308937015*^9}, {
  3.545555348906969*^9, 3.545555353314102*^9}, {3.576225600595799*^9, 
  3.576225601891779*^9}, {3.608289944085484*^9, 3.608289945261012*^9}, {
  3.6398168332600718`*^9, 
  3.639816835492371*^9}},ExpressionUUID->"81e507f9-777a-48f7-b932-\
39bb5b95cdca"],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"\[Beta]", "[", "\[Tau]", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox["\[Beta]", "\[Prime]",
    MultilineFunction->None], "[", "\[Tau]", "]"}]}]], "Output",
 CellChangeTimes->{{3.5455552813394833`*^9, 3.54555531747125*^9}, 
   3.545555354553423*^9, 3.545555682650148*^9, 3.54555634181754*^9, 
   3.545556395711813*^9, {3.57622559436316*^9, 3.5762256025853033`*^9}, 
   3.6082899479351587`*^9, 3.639718768725032*^9, 3.639816836308824*^9, {
   3.6398173930044317`*^9, 3.639817412609508*^9}, 3.639817456244213*^9, 
   3.641281916797783*^9},ExpressionUUID->"028e2e2a-7694-4eec-9be3-\
67c8c9877d82"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"rb", " ", "\[Lambda]"}], "+", 
     RowBox[{"\[Nu]1", " ", "\[Sigma]11"}], "+", 
     RowBox[{"\[Nu]2", " ", "\[Sigma]12"}]}], ")"}], " ", 
   RowBox[{"\[Beta]", "[", "\[Tau]", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Nu]1", "2"], "+", 
     SuperscriptBox["\[Nu]2", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"\[Beta]", "[", "\[Tau]", "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox["\[Alpha]", "\[Prime]",
    MultilineFunction->None], "[", "\[Tau]", "]"}]}]], "Output",
 CellChangeTimes->{{3.5455552813394833`*^9, 3.54555531747125*^9}, 
   3.545555354553423*^9, 3.545555682650148*^9, 3.54555634181754*^9, 
   3.545556395711813*^9, {3.57622559436316*^9, 3.5762256025853033`*^9}, 
   3.6082899479351587`*^9, 3.639718768725032*^9, 3.639816836308824*^9, {
   3.6398173930044317`*^9, 3.639817412609508*^9}, 3.639817456244213*^9, 
   3.6412819167990093`*^9},ExpressionUUID->"4e0a4ba5-fd10-479f-9510-\
9738da6c9b18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Beta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"ODE\[Beta]", "\[Equal]", "0"}]}], "}"}], ",", 
     RowBox[{"\[Beta]", "[", "\[Tau]", "]"}], ",", "\[Tau]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.545382584359974*^9, 3.5453826050498943`*^9}, {
  3.545555326250437*^9, 3.545555368162681*^9}, {3.545555415347612*^9, 
  3.545555417451085*^9}, {3.545556345283662*^9, 3.545556349883634*^9}, {
  3.5762256049556217`*^9, 3.576225608339642*^9}, {3.608289951614037*^9, 
  3.6082899639341707`*^9}, {3.639816840076227*^9, 
  3.63981684514818*^9}},ExpressionUUID->"42911dff-27b6-48f8-b477-\
49c95e7a6b5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Beta]", "[", "\[Tau]", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[Lambda]"}], " ", "\[Tau]"}]]}], "\[Lambda]"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.545382600588895*^9, 3.545382605518146*^9}, 
   3.5453882231828413`*^9, {3.5455553381665993`*^9, 3.545555368808096*^9}, 
   3.545555418089327*^9, 3.545555684278612*^9, 3.545556350743541*^9, 
   3.545556396697624*^9, 3.5762256092614107`*^9, 3.6082899651491013`*^9, 
   3.639718768811736*^9, 3.639816846204021*^9, 3.6398168831567183`*^9, {
   3.6398169734947567`*^9, 3.639816986339265*^9}, {3.6398173930655403`*^9, 
   3.639817412662848*^9}, 3.639817456294099*^9, 
   3.6412819168430567`*^9},ExpressionUUID->"442b91d8-3258-4edc-91c2-\
7a2b764478e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "[", "\[Tau]_", "]"}], ":=", 
  FractionBox[
   RowBox[{"1", "-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", "\[Tau]"}]]}], "\[Lambda]"]}]], "Input",\

 CellChangeTimes->{{3.545555442256961*^9, 3.545555454564803*^9}, {
  3.545556358507859*^9, 3.545556387004157*^9}, {3.57622561387751*^9, 
  3.576225627851975*^9}, {3.608289968142034*^9, 3.608289978568729*^9}, {
  3.63981690136471*^9, 
  3.6398169017648497`*^9}},ExpressionUUID->"d0e91c15-e54f-4e25-a240-\
91f3bc501fd8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ODE\[Alpha]", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Alpha]", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
     
     RowBox[{"\[Alpha]", "[", "\[Tau]", "]"}], ",", "\[Tau]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.545382610897728*^9, 3.545382647864087*^9}, {
  3.5455553775675*^9, 3.545555421147044*^9}, {3.545556364915999*^9, 
  3.5455563711478977`*^9}, {3.576225632172329*^9, 3.576225635892208*^9}, {
  3.608289985110504*^9, 3.608289995670784*^9}, {3.639816890484665*^9, 
  3.639816897356963*^9}},ExpressionUUID->"5056fa61-effd-43b7-903d-\
da98d80fa5a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Alpha]", "[", "\[Tau]", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[Nu]1", "2"]}], "-", 
       SuperscriptBox["\[Nu]2", "2"], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[Lambda]", " ", "\[Tau]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rb", " ", 
           SuperscriptBox["\[Lambda]", "2"]}], "+", 
          SuperscriptBox["\[Nu]1", "2"], "+", 
          RowBox[{"\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11"}], "+", 
          RowBox[{"\[Nu]2", " ", 
           RowBox[{"(", 
            RowBox[{"\[Nu]2", "+", 
             RowBox[{"\[Lambda]", " ", "\[Sigma]12"}]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "rb", " ", 
           SuperscriptBox["\[Lambda]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
          RowBox[{
          "4", " ", "\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Nu]1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
          RowBox[{"\[Nu]2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "\[Lambda]", " ", "\[Sigma]12", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
             RowBox[{"\[Nu]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["\[Lambda]", "3"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.545382635852532*^9, 3.545382648567327*^9}, 
   3.5453882288199673`*^9, {3.545555385628149*^9, 3.545555421941577*^9}, 
   3.545555457309147*^9, 3.545555686540996*^9, {3.5455563736928062`*^9, 
   3.545556399516897*^9}, 3.576225637781867*^9, 3.608289998010697*^9, 
   3.639718768967992*^9, 3.639816904341888*^9, 3.639816997121458*^9, {
   3.6398173931580133`*^9, 3.6398174129307833`*^9}, 3.63981745655797*^9, 
   3.641281917133638*^9},ExpressionUUID->"312d4fe5-c5de-449b-b9b4-\
53ae7695d545"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]", "[", "\[Tau]_", "]"}], ":=", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[Nu]1", "2"]}], "-", 
      SuperscriptBox["\[Nu]2", "2"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[Lambda]", " ", "\[Tau]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rb", " ", 
          SuperscriptBox["\[Lambda]", "2"]}], "+", 
         SuperscriptBox["\[Nu]1", "2"], "+", 
         RowBox[{"\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11"}], "+", 
         RowBox[{"\[Nu]2", " ", 
          RowBox[{"(", 
           RowBox[{"\[Nu]2", "+", 
            RowBox[{"\[Lambda]", " ", "\[Sigma]12"}]}], ")"}]}]}], ")"}]}], 
      "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "rb", " ", 
          SuperscriptBox["\[Lambda]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
         RowBox[{"4", " ", "\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Nu]1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
         RowBox[{"\[Nu]2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "\[Lambda]", " ", "\[Sigma]12", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"\[Lambda]", " ", "\[Tau]"}]}], ")"}]}], "+", 
            RowBox[{"\[Nu]2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", 
               RowBox[{"2", " ", "\[Lambda]", " ", "\[Tau]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["\[Lambda]", "3"]}]]}]], "Input",
 CellChangeTimes->{{3.5455554662540607`*^9, 3.545555476592957*^9}, 
   3.545555693246069*^9, {3.545556381409544*^9, 3.5455563838799562`*^9}, {
   3.5762256440485783`*^9, 3.576225646246642*^9}, {3.608290012794517*^9, 
   3.608290016408688*^9}, 3.608290090690804*^9, {3.6398170047290497`*^9, 
   3.639817008800074*^9}},ExpressionUUID->"f3b35e74-15f5-4336-9a2c-\
055eb696ad29"],

Cell["Verification", "Text",
 CellChangeTimes->{{3.545555490636592*^9, 
  3.545555492202668*^9}},ExpressionUUID->"12db34de-8f24-4a15-a3c3-\
55f8cad67620"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDE", "//", "PS"}]], "Input",
 CellChangeTimes->{{3.545555494347239*^9, 3.545555499420096*^9}, {
  3.608290068144724*^9, 
  3.6082900683443727`*^9}},ExpressionUUID->"24129960-9813-4993-ba76-\
6925fb1d2e43"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.5455554951375093`*^9, 3.545555500160016*^9}, 
   3.5455556997917337`*^9, 3.545556404784532*^9, 3.576225650543439*^9, 
   3.608290021737068*^9, {3.608290084400173*^9, 3.608290097837089*^9}, 
   3.639718769149034*^9, 3.639817012260968*^9, {3.639817393707224*^9, 
   3.6398174133684607`*^9}, 3.639817457017457*^9, 
   3.64128191765987*^9},ExpressionUUID->"e02dcd30-aace-4978-b6b1-\
2b59026a24bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Futures option pricing (Additional Exercise 10)", "Subsection",
 CellChangeTimes->{{3.545388261424787*^9, 3.545388263072361*^9}, {
  3.5762294339276457`*^9, 3.576229435787027*^9}, {3.639817019501926*^9, 
  3.639817022813352*^9}, {3.767430143344049*^9, 
  3.76743016396935*^9}},ExpressionUUID->"7e550ab7-7625-4f54-84f2-\
b5a22239923d"],

Cell[BoxData[
 RowBox[{"Clear", "[", "P", "]"}]], "Input",
 CellChangeTimes->{{3.545388432241696*^9, 3.5453884340198193`*^9}, {
  3.6082901036895123`*^9, 3.608290104193316*^9}, {3.639817163136026*^9, 
  3.639817164303945*^9}, {3.6398174641164618`*^9, 
  3.639817464691527*^9}},ExpressionUUID->"38481261-43a2-4b93-ae9a-\
c6a19d86cdf1"],

Cell[TextData[{
 "The PDE for the option price P(t,r,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "1"], TraditionalForm]],ExpressionUUID->
  "65ba9cf5-c23b-491c-a3a0-0035e5c279e4"],
 ") is given by"
}], "Text",
 CellChangeTimes->{{3.545556415778821*^9, 3.545556429458746*^9}, {
  3.639718685039825*^9, 3.639718687956512*^9}, {3.639817029427492*^9, 
  3.639817029427534*^9}},ExpressionUUID->"b2ac2b83-d82c-440e-851f-\
f75a02d00733"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDE", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "t"], 
     RowBox[{"P", "[", 
      RowBox[{"t", ",", "r", ",", "f"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "r"], 
      RowBox[{"P", "[", 
       RowBox[{"t", ",", "r", ",", "f"}], "]"}]}], "*", "\[Lambda]", "*", 
     RowBox[{"(", 
      RowBox[{"rb", "-", "r"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"r", ",", "r"}]], 
      RowBox[{"P", "[", 
       RowBox[{"t", ",", "r", ",", "f"}], "]"}]}], "*", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Nu]1", "2"], "+", 
       SuperscriptBox["\[Nu]2", "2"]}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", "2"], "*", 
     SuperscriptBox["f", "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Sigma]11", "+", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{
             SuperscriptBox["T", "*"], "-", "t"}], "]"}], "\[Nu]1"}]}], ")"}],
         "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Sigma]12", "+", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{
             SuperscriptBox["T", "*"], "-", "t"}], "]"}], "\[Nu]2"}]}], ")"}],
         "2"]}], ")"}], "*", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"f", ",", "f"}]], 
      RowBox[{"P", "[", 
       RowBox[{"t", ",", "r", ",", "f"}], "]"}]}]}], "+", 
    RowBox[{"f", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Nu]1", " ", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]11", "+", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{
             SuperscriptBox["T", "*"], "-", "t"}], "]"}], "\[Nu]1"}]}], 
         ")"}]}], "+", 
       RowBox[{"\[Nu]2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Sigma]12", "+", 
          RowBox[{
           RowBox[{"\[Beta]", "[", 
            RowBox[{
             SuperscriptBox["T", "*"], "-", "t"}], "]"}], "\[Nu]2"}]}], 
         ")"}]}]}], ")"}], "*", 
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"r", ",", "f"}]], 
      RowBox[{"P", "[", 
       RowBox[{"t", ",", "r", ",", "f"}], "]"}]}]}], "-", 
    RowBox[{"r", "*", 
     RowBox[{"P", "[", 
      RowBox[{"t", ",", "r", ",", "f"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.545388270091399*^9, 3.545388419160533*^9}, {
  3.6398170421682587`*^9, 3.639817158442116*^9}, {3.63981757024089*^9, 
  3.639817580015031*^9}},ExpressionUUID->"af41c98c-657f-4a3e-8624-\
0b62c92b41b8"],

Cell["Our conjecture is that", "Text",
 CellChangeTimes->{{3.5455564338191843`*^9, 
  3.545556437850959*^9}},ExpressionUUID->"6be291ee-b035-4281-a209-\
1b62890f592b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"P", "[", 
   RowBox[{"t_", ",", "r_", ",", "f_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"B", "[", 
    RowBox[{
     RowBox[{"T", "-", "t"}], ",", "r"}], "]"}], 
   RowBox[{"G", "[", 
    RowBox[{"t", ",", "f"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.545388423384625*^9, 3.545388468758757*^9}, {
   3.5455555152308807`*^9, 3.5455555308710546`*^9}, 3.545555600336948*^9, {
   3.545555708177678*^9, 3.545555710497902*^9}, {3.545556440775064*^9, 
   3.545556453758301*^9}, {3.576225664685034*^9, 3.576225675405342*^9}, {
   3.608290114450678*^9, 3.608290130341378*^9}, {3.639718698688898*^9, 
   3.639718700455875*^9}, {3.639817174497754*^9, 3.639817195009194*^9}, {
   3.639817473564237*^9, 3.639817484724045*^9}, 
   3.639817587325334*^9},ExpressionUUID->"9b2407f4-e5a6-49df-81c9-\
b8f97b7e4ee5"],

Cell["\<\
Substituting this conjecture into the PDE for the function P gives\
\>", "Text",
 CellChangeTimes->{{3.639718721262834*^9, 
  3.639718742263341*^9}},ExpressionUUID->"4f192252-1e16-4a4c-b35c-\
1c3728bb2c7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDE0", "=", 
  RowBox[{
   FractionBox["PDE", 
    RowBox[{"B", "[", 
     RowBox[{
      RowBox[{"T", "-", "t"}], ",", "r"}], "]"}]], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.5455555414896097`*^9, 3.545555541812784*^9}, {
  3.545555579190988*^9, 3.545555644499804*^9}, {3.545555726393388*^9, 
  3.545555745417547*^9}, {3.545555775651392*^9, 3.5455558168841143`*^9}, {
  3.545555858052704*^9, 3.545555858212532*^9}, {3.545555971636633*^9, 
  3.545555973341867*^9}, {3.545556089144937*^9, 3.545556090768283*^9}, {
  3.5455564621664543`*^9, 3.545556472206264*^9}, {3.5762256792375298`*^9, 
  3.576225687125491*^9}, {3.6082901367095127`*^9, 3.608290139973456*^9}, {
  3.639817260569709*^9, 3.639817314066174*^9}, {3.639817599165472*^9, 
  3.639817603029492*^9}},ExpressionUUID->"bc8167a1-e528-4d92-91e3-\
71a8d7e85c8b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[Lambda]", "2"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "\[Lambda]"}], " ", 
     RowBox[{"(", 
      RowBox[{"T", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["T", "*"]}]}], ")"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Lambda]", " ", 
        SuperscriptBox["T", "*"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"t", " ", "\[Lambda]"}]], "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"T", " ", "\[Lambda]"}]]}], ")"}], " ", "f", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"t", " ", "\[Lambda]"}]]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Nu]1", "2"], "+", 
           SuperscriptBox["\[Nu]2", "2"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[Lambda]", " ", 
           SuperscriptBox["T", "*"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Nu]1", "2"], "+", 
           RowBox[{"\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11"}], "+", 
           RowBox[{"\[Nu]2", " ", 
            RowBox[{"(", 
             RowBox[{"\[Nu]2", "+", 
              RowBox[{"\[Lambda]", " ", "\[Sigma]12"}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["G", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "f"}], "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"T", " ", "\[Lambda]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["f", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"2", " ", "t", " ", "\[Lambda]"}]], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Nu]1", "2"], "+", 
              SuperscriptBox["\[Nu]2", "2"]}], ")"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[Lambda]", " ", 
              RowBox[{"(", 
               RowBox[{"t", "+", 
                SuperscriptBox["T", "*"]}], ")"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Nu]1", "2"], "+", 
              RowBox[{"\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11"}], "+", 
              RowBox[{"\[Nu]2", " ", 
               RowBox[{"(", 
                RowBox[{"\[Nu]2", "+", 
                 RowBox[{"\[Lambda]", " ", "\[Sigma]12"}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"2", " ", "\[Lambda]", " ", 
              SuperscriptBox["T", "*"]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Nu]1", "2"], "+", 
              SuperscriptBox["\[Nu]2", "2"], "+", 
              RowBox[{
              "2", " ", "\[Lambda]", " ", "\[Nu]1", " ", "\[Sigma]11"}], "+", 
              
              RowBox[{
              "2", " ", "\[Lambda]", " ", "\[Nu]2", " ", "\[Sigma]12"}], "+", 
              
              RowBox[{
               SuperscriptBox["\[Lambda]", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Sigma]11", "2"], "+", 
                 SuperscriptBox["\[Sigma]12", "2"]}], ")"}]}]}], ")"}]}]}], 
          ")"}], " ", 
         RowBox[{
          SuperscriptBox["G", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "f"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", "\[Lambda]", " ", 
           SuperscriptBox["T", "*"]}]], " ", 
         SuperscriptBox["\[Lambda]", "2"], " ", 
         RowBox[{
          SuperscriptBox["G", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "f"}], "]"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{
  3.545555542615881*^9, {3.5455555840867777`*^9, 3.545555647614749*^9}, {
   3.5455557193807707`*^9, 3.545555748005992*^9}, 3.545555783537973*^9, 
   3.545555818272031*^9, 3.5455558594619303`*^9, 3.545555973981444*^9, 
   3.545556091514917*^9, 3.545556474649136*^9, 3.5762256882430363`*^9, 
   3.576225727827897*^9, 3.608290148891107*^9, 3.639718769867818*^9, {
   3.639817262476218*^9, 3.639817315539929*^9}, 3.639817604824402*^9, 
   3.639817648652076*^9, 
   3.6412822314610167`*^9},ExpressionUUID->"fdcf77c0-8a39-4f94-8be8-\
70138b764f1e"]
}, Open  ]],

Cell["Simplifying shows that this PDE is equivalent to ", "Text",
 CellChangeTimes->{{3.545556007149262*^9, 3.5455560172836*^9}, {
   3.545556103517168*^9, 3.5455561101492033`*^9}, 
   3.639817954128351*^9},ExpressionUUID->"d3f9787f-9c61-4a77-abf3-\
02db694cb031"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDE00", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["G", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"t", ",", "f"}], "]"}], "-", 
    RowBox[{
     RowBox[{"\[Delta]f", "[", "t", "]"}], " ", "*", "f", "*", " ", 
     RowBox[{
      SuperscriptBox["G", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "f"}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], "*", 
     SuperscriptBox[
      RowBox[{"\[Sigma]f", "[", "t", "]"}], "2"], "*", 
     SuperscriptBox["f", "2"], "*", " ", 
     RowBox[{
      SuperscriptBox["G", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "f"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.545556026623239*^9, 3.545556069986082*^9}, {
   3.54555647909597*^9, 3.5455564815832653`*^9}, {3.576229386231001*^9, 
   3.576229388948674*^9}, {3.6082901614762163`*^9, 3.6082901707806377`*^9}, {
   3.6398178796811867`*^9, 3.639817931209675*^9}, 3.639818037354515*^9, {
   3.639818071683243*^9, 
   3.639818073675394*^9}},ExpressionUUID->"2e15b9ba-88d4-4687-b5cb-\
b280a9441f62"],

Cell["with the deterministic functions", "Text",
 CellChangeTimes->{{3.6398179572167053`*^9, 3.639817966008299*^9}, {
  3.639818043929435*^9, 
  3.639818049233429*^9}},ExpressionUUID->"314464b3-e21c-41ed-b2c1-\
9bdb31468581"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]f", "[", "t_", "]"}], ":=", 
  RowBox[{
   RowBox[{"b", "[", 
    RowBox[{"T", "-", "t"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Nu]1", "2"], "+", 
        SuperscriptBox["\[Nu]2", "2"]}], ")"}], 
      RowBox[{"\[Beta]", "[", 
       RowBox[{
        SuperscriptBox["T", "*"], "-", "t"}], "]"}]}], "+", 
     RowBox[{"\[Nu]1", " ", "\[Sigma]11"}], "+", 
     RowBox[{"\[Nu]2", " ", "\[Sigma]12"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]f", "[", "t_", "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Sigma]11", "+", 
        RowBox[{
         RowBox[{"\[Beta]", "[", 
          RowBox[{
           SuperscriptBox["T", "*"], "-", "t"}], "]"}], "\[Nu]1"}]}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Sigma]12", "+", 
        RowBox[{
         RowBox[{"\[Beta]", "[", 
          RowBox[{
           SuperscriptBox["T", "*"], "-", "t"}], "]"}], "\[Nu]2"}]}], ")"}], 
      "2"]}], ")"}], 
   RowBox[{"1", "/", "2"}]]}]}], "Input",
 CellChangeTimes->{{3.641282129570133*^9, 
  3.6412821432684183`*^9}},ExpressionUUID->"76cce870-8b61-4b24-85f1-\
4c7f1f6687df"],

Cell["Indeed:", "Text",
 CellChangeTimes->{{3.5455560720457573`*^9, 
  3.545556073508935*^9}},ExpressionUUID->"14b951e6-d97a-46b0-bbb8-\
f4ebe0dcd127"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PDE0", "-", "PDE00"}], "//", "PS"}]], "Input",
 CellChangeTimes->{{3.545555785544269*^9, 3.545555833225779*^9}, {
  3.5455558661875896`*^9, 3.545555983605793*^9}, {3.545556075054018*^9, 
  3.545556085365748*^9}, {3.641282190205267*^9, 
  3.641282191004006*^9}},ExpressionUUID->"3980dede-71df-4e54-b5a5-\
ebb362a53c88"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.545555797991592*^9, 3.5455558710326023`*^9}, {
   3.545555933200549*^9, 3.545555984348146*^9}, {3.5455560810843143`*^9, 
   3.5455560860732317`*^9}, 3.545556485064664*^9, 3.576229391812902*^9, 
   3.608290174306016*^9, 3.6397187700291033`*^9, 3.639817977299008*^9, 
   3.641282163119873*^9, {3.641282200182143*^9, 3.641282217926135*^9}, 
   3.641282250901978*^9},ExpressionUUID->"b7a3096a-53b4-4641-9804-\
0a46a93813c7"]
}, Open  ]],

Cell["\<\
The solution of this PDE can be derived by analogy with the BSM formula by \
noting that the PDE is the same as that which would prevail for the price of \
a call in a BSM model where the interest rate is zero, the asset pays \
dividends at the determinitsic rate \[Delta]f[t] and has determinitsic \
volatility equal to \[Sigma]f[t]. Explicitly\
\>", "Text",
 CellChangeTimes->{{3.639817999330244*^9, 
  3.639818155322693*^9}},ExpressionUUID->"61592bc0-c8db-4829-baa0-\
818fe9ecdb20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G", "[", 
   RowBox[{"t_", ",", "f_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"\[CapitalDelta]f", "[", 
        RowBox[{"t", ",", "T"}], "]"}]}], 
      RowBox[{"(", 
       RowBox[{"T", "-", "t"}], ")"}]}], "]"}], " ", "f", "*", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"\[CapitalSigma]", "[", 
          RowBox[{"t", ",", "T"}], "]"}], "*", 
         SqrtBox[
          RowBox[{"T", "-", "t"}]]}]], "*", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[CapitalDelta]f", "[", 
              RowBox[{"t", ",", "T"}], "]"}]}], 
            RowBox[{"(", 
             RowBox[{"T", "-", "t"}], ")"}]}], "]"}], "f"}], "K"], "]"}]}], 
      "+", 
      RowBox[{
       FractionBox["1", "2"], "*", 
       RowBox[{"\[CapitalSigma]", "[", 
        RowBox[{"t", ",", "T"}], "]"}], "*", 
       SqrtBox[
        RowBox[{"T", "-", "t"}]]}]}], "]"}]}], "-", 
   RowBox[{"K", "*", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{
         RowBox[{"\[CapitalSigma]", "[", 
          RowBox[{"t", ",", "T"}], "]"}], "*", 
         SqrtBox[
          RowBox[{"T", "-", "t"}]]}]], "*", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"\[CapitalDelta]f", "[", 
              RowBox[{"t", ",", "T"}], "]"}]}], 
            RowBox[{"(", 
             RowBox[{"T", "-", "t"}], ")"}]}], "]"}], "f"}], "K"], "]"}]}], 
      "-", 
      RowBox[{
       FractionBox["1", "2"], "*", 
       RowBox[{"\[CapitalSigma]", "[", 
        RowBox[{"t", ",", "T"}], "]"}], "*", 
       SqrtBox[
        RowBox[{"T", "-", "t"}]]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.545557791675209*^9, {3.6398181654210587`*^9, 
   3.639818254280384*^9}},ExpressionUUID->"aa4aa71b-0f97-4a95-ae44-\
cb9c12145109"],

Cell["\<\
where the effective volatility and dividend yields are defined by\
\>", "Text",
 CellChangeTimes->{{3.545557655295013*^9, 3.545557666823333*^9}, {
  3.545557802052503*^9, 3.545557804434072*^9}, {3.639818260452839*^9, 
  3.639818267387967*^9}},ExpressionUUID->"47d27970-de19-480f-b738-\
dd96b29afb2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]", "[", 
   RowBox[{"t_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"\[Sqrt]", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"T", "-", "t"}]], "*", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "t", "T"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"\[Sigma]f", "[", "s", "]"}], "2"], 
       RowBox[{"\[DifferentialD]", "s"}]}]}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]f", "[", 
   RowBox[{"t_", ",", "T_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"T", "-", "t"}]], 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "t", "T"], 
    RowBox[{
     RowBox[{"\[Delta]f", "[", "s", "]"}], 
     RowBox[{"\[DifferentialD]", "s"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.5455561776787767`*^9, 3.545556273668989*^9}, {
  3.5455564907134523`*^9, 3.5455564986726217`*^9}, {3.576229403821392*^9, 
  3.5762294067255096`*^9}, {3.608290186836836*^9, 3.608290194932941*^9}, {
  3.639818269437523*^9, 
  3.639818318413794*^9}},ExpressionUUID->"f9c5bb21-1372-4760-b041-\
8d491e30d694"],

Cell["and", "Text",
 CellChangeTimes->{{3.639818331557952*^9, 
  3.639818347356863*^9}},ExpressionUUID->"adf9d17d-36c1-4bfa-949f-\
018deb658b1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalPhi]", "[", "x_", "]"}], ":=", 
  RowBox[{"CDF", "[", 
   RowBox[{
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}]], "Input",ExpressionU\
UID->"2cd94924-a95a-4504-bef3-2ce6d11ca69e"],

Cell["gives the cdf of a normal distribution", "Text",
 CellChangeTimes->{{3.639818350436906*^9, 3.639818359676894*^9}, {
  3.641279984506525*^9, 
  3.641279986602523*^9}},ExpressionUUID->"e5ae89f0-ea98-42f5-8923-\
7cb78ef4d76c"],

Cell["\<\
When the interest rate is non random we have \[Nu] = 0 and it follows that\
\>", "Text",
 CellChangeTimes->{{3.641279956499633*^9, 
  3.641279977636747*^9}},ExpressionUUID->"8ef62efc-6dbf-4614-af0c-\
875f419281e1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]f", "[", "t", "]"}], "/.", 
   RowBox[{"\[Nu]1", "\[Rule]", "0"}]}], "/.", 
  RowBox[{"\[Nu]2", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]f", "[", "t", "]"}], "/.", 
   RowBox[{"\[Nu]1", "\[Rule]", "0"}]}], "/.", 
  RowBox[{"\[Nu]2", "\[Rule]", "0"}]}]}], "Input",
 CellChangeTimes->{{3.639820108244873*^9, 
  3.639820129181122*^9}},ExpressionUUID->"706e1cb8-baba-479f-944a-\
a592d4d13802"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6398201214438047`*^9, 
  3.639820130179659*^9}},ExpressionUUID->"3784ceb8-ab41-4f4e-a0ff-\
c49aa27e958b"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SuperscriptBox["\[Sigma]11", "2"], "+", 
   SuperscriptBox["\[Sigma]12", "2"]}]]], "Output",
 CellChangeTimes->{{3.6398201214438047`*^9, 
  3.639820130180545*^9}},ExpressionUUID->"760569c7-e284-4cb1-a2dd-\
0b6972bb9107"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2560, 1391},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Simple.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 301, 7, 76, "Section",ExpressionUUID->"60710e51-9698-4779-9391-eab9d004ee39"],
Cell[CellGroupData[{
Cell[905, 33, 221, 4, 68, "Subsection",ExpressionUUID->"0b4d1ce0-7d70-49d4-bef4-8a3707cf5341"],
Cell[1129, 39, 1235, 37, 92, "Input",ExpressionUUID->"3edfc7a1-f9e0-4eef-b8d1-135823d6c14f"],
Cell[2367, 78, 753, 17, 98, "Input",ExpressionUUID->"890fc6d9-4944-47e6-9398-1da66cdbe32b"],
Cell[CellGroupData[{
Cell[3145, 99, 795, 21, 89, "Input",ExpressionUUID->"b79d8357-301a-43a2-8da5-fc0476ac6d60"],
Cell[3943, 122, 1265, 33, 67, "Output",ExpressionUUID->"a41e7287-1e6d-48bc-bee5-5294fcd7c78a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5245, 160, 596, 14, 98, "Input",ExpressionUUID->"d1f080e0-b794-4fc1-9f62-e5b8904b8ff3"],
Cell[5844, 176, 654, 14, 50, "Output",ExpressionUUID->"fd79787c-57ce-40c0-b985-2b66d8af52e6"],
Cell[6501, 192, 994, 26, 67, "Output",ExpressionUUID->"fc73fc1a-47d7-42db-b109-43d9bb87aae3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7532, 223, 750, 17, 68, "Input",ExpressionUUID->"eaa30d21-51d2-4a19-a8f4-71e311c08e4e"],
Cell[8285, 242, 744, 17, 71, "Output",ExpressionUUID->"e94eab3c-0d2d-431f-81d0-2b1cbfed55ce"]
}, Open  ]],
Cell[9044, 262, 509, 13, 89, "Input",ExpressionUUID->"4245f460-36f6-4864-abef-81ab59d7c3c7"],
Cell[CellGroupData[{
Cell[9578, 279, 698, 17, 68, "Input",ExpressionUUID->"db9f3ea4-aaac-452f-b475-602a7aea011e"],
Cell[10279, 298, 2037, 52, 75, "Output",ExpressionUUID->"40919ea6-23ac-4379-a2b9-4bd9020fcf82"]
}, Open  ]],
Cell[12331, 353, 1828, 49, 93, "Input",ExpressionUUID->"b9f2b1dc-9a4b-4ccf-9ff9-a7570bcf48a5"],
Cell[14162, 404, 154, 3, 53, "Text",ExpressionUUID->"ecf19b56-e372-42d8-a96f-b12e666ee1a7"],
Cell[CellGroupData[{
Cell[14341, 411, 230, 5, 68, "Input",ExpressionUUID->"bda565c8-0568-4078-939f-512446472f3f"],
Cell[14574, 418, 423, 7, 50, "Output",ExpressionUUID->"79c8b861-de33-4ad6-b208-1d8c3e74faa5"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[15046, 431, 259, 4, 42, "Subsection",ExpressionUUID->"1fae1f78-3209-4a57-a62a-b5bf4f27c100"],
Cell[15308, 437, 689, 21, 55, "Text",ExpressionUUID->"f2c6be22-b0c6-4701-b4b8-d61ac8d8a992"],
Cell[16000, 460, 2619, 80, 85, "Input",ExpressionUUID->"499c432d-68aa-441c-982b-e12e6a4bc592"],
Cell[18622, 542, 172, 3, 53, "Text",ExpressionUUID->"d953b212-95fa-4d14-b536-4c30efaab826"],
Cell[18797, 547, 920, 22, 68, "Input",ExpressionUUID->"788c07ba-9dc4-4045-bfd9-c2a1a78bf61b"],
Cell[19720, 571, 177, 3, 53, "Text",ExpressionUUID->"db5e8d2f-ed99-4847-a574-91f7d6a4dc93"],
Cell[CellGroupData[{
Cell[19922, 578, 737, 18, 89, "Input",ExpressionUUID->"ee7e6330-ec8a-4677-9cc7-ce4344eb1441"],
Cell[20662, 598, 1435, 34, 67, "Output",ExpressionUUID->"d1c6e41d-7a6c-41ec-9018-c903e1b0093f"]
}, Open  ]],
Cell[22112, 635, 211, 4, 53, "Text",ExpressionUUID->"03f3968b-f4dd-43df-b62f-3e8b42565994"],
Cell[CellGroupData[{
Cell[22348, 643, 660, 15, 98, "Input",ExpressionUUID->"81e507f9-777a-48f7-b932-39bb5b95cdca"],
Cell[23011, 660, 669, 13, 50, "Output",ExpressionUUID->"028e2e2a-7694-4eec-9be3-67c8c9877d82"],
Cell[23683, 675, 1072, 26, 67, "Output",ExpressionUUID->"4e0a4ba5-fd10-479f-9510-9738da6c9b18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24792, 706, 816, 18, 68, "Input",ExpressionUUID->"42911dff-27b6-48f8-b477-49c95e7a6b5b"],
Cell[25611, 726, 850, 18, 71, "Output",ExpressionUUID->"442b91d8-3258-4edc-91c2-7a2b764478e8"]
}, Open  ]],
Cell[26476, 747, 565, 14, 89, "Input",ExpressionUUID->"d0e91c15-e54f-4e25-a240-91f3bc501fd8"],
Cell[CellGroupData[{
Cell[27066, 765, 771, 18, 68, "Input",ExpressionUUID->"5056fa61-effd-43b7-903d-da98d80fa5a6"],
Cell[27840, 785, 2993, 74, 75, "Output",ExpressionUUID->"312d4fe5-c5de-449b-b9b4-53ae7695d545"]
}, Open  ]],
Cell[30848, 862, 2754, 70, 93, "Input",ExpressionUUID->"f3b35e74-15f5-4336-9a2c-055eb696ad29"],
Cell[33605, 934, 154, 3, 53, "Text",ExpressionUUID->"12db34de-8f24-4a15-a3c3-55f8cad67620"],
Cell[CellGroupData[{
Cell[33784, 941, 230, 5, 68, "Input",ExpressionUUID->"24129960-9813-4993-ba76-6925fb1d2e43"],
Cell[34017, 948, 444, 7, 50, "Output",ExpressionUUID->"e02dcd30-aace-4978-b6b1-2b59026a24bf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34510, 961, 340, 5, 68, "Subsection",ExpressionUUID->"7e550ab7-7625-4f54-84f2-b5a22239923d"],
Cell[34853, 968, 334, 6, 68, "Input",ExpressionUUID->"38481261-43a2-4b93-ae9a-c6a19d86cdf1"],
Cell[35190, 976, 436, 11, 54, "Text",ExpressionUUID->"b2ac2b83-d82c-440e-851f-f75a02d00733"],
Cell[35629, 989, 2633, 81, 89, "Input",ExpressionUUID->"af41c98c-657f-4a3e-8624-0b62c92b41b8"],
Cell[38265, 1072, 166, 3, 53, "Text",ExpressionUUID->"6be291ee-b035-4281-a209-1b62890f592b"],
Cell[38434, 1077, 834, 18, 68, "Input",ExpressionUUID->"9b2407f4-e5a6-49df-81c9-b8f97b7e4ee5"],
Cell[39271, 1097, 216, 5, 53, "Text",ExpressionUUID->"4f192252-1e16-4a4c-b35c-1c3728bb2c7b"],
Cell[CellGroupData[{
Cell[39512, 1106, 857, 17, 89, "Input",ExpressionUUID->"bc8167a1-e528-4d92-91e3-71a8d7e85c8b"],
Cell[40372, 1125, 5123, 139, 109, "Output",ExpressionUUID->"fdcf77c0-8a39-4f94-8be8-70138b764f1e"]
}, Open  ]],
Cell[45510, 1267, 264, 4, 53, "Text",ExpressionUUID->"d3f9787f-9c61-4a77-abf3-02db694cb031"],
Cell[45777, 1273, 1390, 41, 85, "Input",ExpressionUUID->"2e15b9ba-88d4-4687-b5cb-b280a9441f62"],
Cell[47170, 1316, 225, 4, 53, "Text",ExpressionUUID->"314464b3-e21c-41ed-b2c1-9bdb31468581"],
Cell[47398, 1322, 1324, 43, 104, "Input",ExpressionUUID->"76cce870-8b61-4b24-85f1-4c7f1f6687df"],
Cell[48725, 1367, 151, 3, 53, "Text",ExpressionUUID->"14b951e6-d97a-46b0-bbb8-f4ebe0dcd127"],
Cell[CellGroupData[{
Cell[48901, 1374, 353, 7, 68, "Input",ExpressionUUID->"3980dede-71df-4e54-b5a5-ebb362a53c88"],
Cell[49257, 1383, 471, 7, 50, "Output",ExpressionUUID->"b7a3096a-53b4-4641-9804-0a46a93813c7"]
}, Open  ]],
Cell[49743, 1393, 495, 9, 88, "Text",ExpressionUUID->"61592bc0-c8db-4829-baa0-818fe9ecdb20"],
Cell[50241, 1404, 2162, 69, 93, "Input",ExpressionUUID->"aa4aa71b-0f97-4a95-ae44-cb9c12145109"],
Cell[52406, 1475, 310, 6, 53, "Text",ExpressionUUID->"47d27970-de19-480f-b738-dd96b29afb2d"],
Cell[52719, 1483, 1117, 32, 154, "Input",ExpressionUUID->"f9c5bb21-1372-4760-b041-8d491e30d694"],
Cell[53839, 1517, 145, 3, 53, "Text",ExpressionUUID->"adf9d17d-36c1-4bfa-949f-018deb658b1a"],
Cell[53987, 1522, 275, 7, 68, "Input",ExpressionUUID->"2cd94924-a95a-4504-bef3-2ce6d11ca69e"],
Cell[54265, 1531, 229, 4, 53, "Text",ExpressionUUID->"e5ae89f0-ea98-42f5-8923-7cb78ef4d76c"],
Cell[54497, 1537, 224, 5, 53, "Text",ExpressionUUID->"8ef62efc-6dbf-4614-af0c-875f419281e1"],
Cell[CellGroupData[{
Cell[54746, 1546, 489, 13, 98, "Input",ExpressionUUID->"706e1cb8-baba-479f-944a-a592d4d13802"],
Cell[55238, 1561, 156, 3, 50, "Output",ExpressionUUID->"3784ceb8-ab41-4f4e-a0ff-c49aa27e958b"],
Cell[55397, 1566, 258, 7, 60, "Output",ExpressionUUID->"760569c7-e284-4cb1-a2dd-0b6972bb9107"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

